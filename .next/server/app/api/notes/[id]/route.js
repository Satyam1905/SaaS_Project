"use strict";(()=>{var e={};e.id=866,e.ids=[866],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},7813:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>y,requestAsyncStorage:()=>x,routeModule:()=>h,serverHooks:()=>w,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{DELETE:()=>f,GET:()=>l,PUT:()=>p});var n=r(9303),a=r(8716),o=r(670),i=r(7070),u=r(650),d=r(9178),c=r(2663);async function l(e,{params:t}){try{let r=(0,u.L)(e);if(!r)return i.NextResponse.json({error:"Unauthorized"},{status:401});let s=d.e.verifyToken(r),n=await c._.note.findFirst({where:{id:t.id,tenantId:s.tenantId},include:{author:{select:{email:!0}}}});if(!n)return i.NextResponse.json({success:!1,error:"Note not found"},{status:404});return i.NextResponse.json({success:!0,data:n})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to fetch note"},{status:500})}}async function p(e,{params:t}){try{let r=(0,u.L)(e);if(!r)return i.NextResponse.json({error:"Unauthorized"},{status:401});let s=d.e.verifyToken(r),{title:n,content:a}=await e.json();if(!await c._.note.findFirst({where:{id:t.id,tenantId:s.tenantId}}))return i.NextResponse.json({success:!1,error:"Note not found"},{status:404});let o=await c._.note.update({where:{id:t.id},data:{title:n,content:a}});return i.NextResponse.json({success:!0,data:o})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to update note"},{status:500})}}async function f(e,{params:t}){try{let r=(0,u.L)(e);if(!r)return i.NextResponse.json({error:"Unauthorized"},{status:401});let s=d.e.verifyToken(r);if(!await c._.note.findFirst({where:{id:t.id,tenantId:s.tenantId}}))return i.NextResponse.json({success:!1,error:"Note not found"},{status:404});return await c._.note.delete({where:{id:t.id}}),i.NextResponse.json({success:!0,message:"Note deleted"})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to delete note"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/notes/[id]/route",pathname:"/api/notes/[id]",filename:"route",bundlePath:"app/api/notes/[id]/route"},resolvedPagePath:"C:\\Users\\satyam patel\\Downloads\\saas_assignment\\saas-notes-app\\app\\api\\notes\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:m,serverHooks:w}=h,j="/api/notes/[id]/route";function y(){return(0,o.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:m})}},9178:(e,t,r)=>{r.d(t,{e:()=>d});var s=r(1482),n=r.n(s),a=r(2023),o=r.n(a),i=r(2663);let u="y48wje903jfe3jed90e4949t493jfe3jed90e4949t49";class d{static async login(e,t){let r=await i._.user.findUnique({where:{email:e},include:{tenant:!0}});if(!r||!await o().compare(t,r.password))throw Error("Invalid credentials");let s={userId:r.id,tenantId:r.tenantId,role:r.role,email:r.email},a=n().sign(s,u,{expiresIn:"7d"});return{user:{id:r.id,email:r.email,role:r.role,tenantId:r.tenantId},token:a,tenant:r.tenant}}static verifyToken(e){try{return n().verify(e,u)}catch(e){throw Error("Invalid token")}}}},2663:(e,t,r)=>{r.d(t,{_:()=>n});let s=require("@prisma/client"),n=globalThis.prisma??new s.PrismaClient},650:(e,t,r)=>{function s(e){let t=e.headers.get("authorization");return t?.startsWith("Bearer ")?t.slice(7):null}r.d(t,{L:()=>s})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,944],()=>r(7813));module.exports=s})();